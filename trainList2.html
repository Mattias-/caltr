<!DOCTYPE html>
<html>
  <head>
    <meta charset="UTF-8">
    <title>Caltr</title>
    <style type="text/css">
      html {
        height: 100%;
      }
      body {
        font: 8pt monospace;
        height: 100%;
      }
      table {
        border-collapse:collapse;
      }
      td {
        border: 1px solid;
        vertical-align: right;
      }
      #map_canvas {
       width:75%;
       height:100%;
       float:left;
      }
    </style>
    <script src="jquery-1.7.2.min.js"></script>
    <script src="date.js"></script>
    <script src="moment.js"></script>
    <script src="trainList2.js"></script>
    <script src="caltr.js"></script>
    <script src="waypoints2.js"></script>
    <script src="https://maps.googleapis.com/maps/api/js?sensor=false&libraries=geometry"></script>
    <script>
       
      var map;
      function initialize() {
        var mapOptions = {
          zoom: 12,
          center: new google.maps.LatLng(37.7761, -122.406),
          mapTypeId: google.maps.MapTypeId.ROADMAP
        };
        map = new google.maps.Map($('#map_canvas')[0], mapOptions);
      }

        function showStops(){
            $.each(waypoints, function(i, wp){
              if(wp.hasOwnProperty('stop')){
                  var p = new google.maps.LatLng(wp.lat, wp.lng); 
                  new google.maps.Marker({
                    position: p,
                    map: map,
                    title: wp.stop + ' ' + wp.name
                  });
              }
            });
        }
       function go(){ 
        $.each(activeTrains, function(i, train){
            var t = new caltr.ActiveTrain({
                trainTimes: train,
                waypoints: waypoints2
            });
            t.run();
        });
       }
      $(document).ready(function(){
        caltr.utils.startDate = moment(Date.parse('2012-08-10 17:05:30'));
        caltr.core.createDateObjects(trains);
        caltr.core.createWpObjects(waypoints2.waypoints);
        var now = caltr.utils.fakeNow();//TODO
        activeTrains = caltr.core.getActiveTrains(trains, now);
        //console.log(activeTrains);
        //tr0 = new ActiveTrain(activeTrains[2]);
        //console.log(tr0);
        initialize();

      });
    </script>
  </head>
  <body>
   <div id="map_canvas"></div> 
  </body>
</html>
